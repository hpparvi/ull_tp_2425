# Multithread Dynamical Simulation using Barnes-Hut and OpenMP, by Oscar Soler Pérez
Here is included the fortran code written to perform a multithread numerical integration of a system consisting of gravitationally interacting particles using the leapfrog integration method and Barnes-Hut algorithm.
The code has been inspired by the notes of the course Técnicas Avanzadas de Programación 2018-2019, Ángel de Vicente, pages 37-47 and pages 74-85.


Initial conditions are created as N point particles randomly distributed in a sphere in the `data/random_bodies.txt` file. The `data/stars.txt` file has the stable three body situation worked in Exercise 1 for checking.


Contains:
- `src`: directory containing all source code: `.f90` files. Both for modules and subroutines and the main program. Also contains a `.py` file to execute and plot results.
- `bin`: directory which stores all non-executable files. That is all `.o` and `.mod` files.
- `data`: directory with the different initial conditions that can be used
- `output`: directory which stores the different output files
- `custom.par`: file in which all custom parameters (time-step, duration, number of particles, file names, ...) are set and can be changed. Can be automatically changed and generated by `python` script.
- `ex2`: executable

Execution:  
After setting up the desired custom parameters, type the following command \\
    `make`
    `ex2 custom.par`

Output:  
Saved to specific directory in `.txt` format, containing the time and all particle positions of each frame in a single line.

Plotting:
Allowed to carry out with the `ploteo.py` python script.

Results:
